import{d as ka,r as c,k as se,C as D,p as Te,a5 as Ma,a8 as L,w as n,x as we,o as F,e as u,a as o,c as I,f as B,ah as Ta,i as H,aa as C,ab as V,t as x,ag as ge,g as f,a9 as be,ac as Ce,ai as U,aj as ga,Q as He,b as te,ak as ba,al as ze,am as Ge}from"./index-B-uU-IwF.js";import{e as X,Q as $,a as q,d as ye,u as ya}from"./QItem-B76h26OC.js";import{Q as Ve,a as Le,b as _e,c as Va,d as ha}from"./QForm-BqX0CH5m.js";import{Q as Ka}from"./QPage-C90HVCFa.js";import{api as K}from"./axios-D2lIpP-a.js";import{_ as Oa}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./QChip-20dD3OR9.js";const Na={class:"row"},Fa={class:"col-12"},xa={class:"containers-wrapper"},Aa={class:"ana-form-wrapper"},Ya={class:"container-header"},Ba={class:"hesap-tipi-section"},Da={class:"ek-bilgiler-toggle"},wa={key:0,class:"kurumsal-fields"},Ca={class:"row no-wrap kurumsal-row"},Ha={class:"col kurumsal-col"},za={class:"col kurumsal-col"},Ga={class:"musteri-fields"},La={class:"row no-wrap musteri-row"},_a={class:"col musteri-col"},Ea={class:"col musteri-col"},Sa={class:"row"},Ia={class:"col-12"},Ua={class:"oda-konaklama-fields"},$a={class:"row no-wrap oda-konaklama-row"},qa={class:"col oda-konaklama-col"},Pa={class:"col oda-konaklama-col"},Ra={class:"row no-wrap oda-konaklama-row"},Qa={class:"col oda-konaklama-col"},ja={class:"col oda-konaklama-col"},Wa={key:0,class:"col oda-konaklama-col"},Xa={class:"bedel-islemler-fields"},Za={class:"row no-wrap bedel-islemler-row"},Ja={class:"col bedel-islemler-col"},el={class:"col bedel-islemler-col"},al={class:"col-auto bedel-islemler-col"},ll={class:"col bedel-islemler-col"},sl={class:"row no-wrap bedel-islemler-row"},tl={class:"col-auto bedel-islemler-col"},ol={class:"col bedel-islemler-col"},rl={class:"col-auto bedel-islemler-col"},il={class:"ek-notlar-fields"},ul={class:"ek-bilgiler-form"},nl={class:"depozito-container"},dl={class:"row items-center justify-center q-gutter-sm"},ml={class:"ek-hizmetler-container"},vl={class:"column q-gutter-sm"},cl={class:"text-center q-mb-md"},pl={class:"q-mb-md"},fl={class:"q-pl-md"},kl={key:0},Ml={key:1},Tl={key:0,class:"q-mb-md"},gl={class:"q-mt-sm q-pa-sm text-red rounded-borders",style:{background:"transparent"}},bl=ka({__name:"musteri-islem",setup(yl){const Ee=ya();async function Se(){const e=sessionStorage.getItem("autoFillTCKimlik");e&&(sessionStorage.removeItem("autoFillTCKimlik"),a.value.MstrTCN=e,await we(),z.value&&(z.value.focus(),setTimeout(()=>{(async()=>z.value&&(z.value.blur(),await Ke().catch(console.error)))()},100)))}const Ie=[{label:"Bireysel",value:"Bireysel"},{label:"Kurumsal",value:"Kurumsal"}],a=c({MstrAdi:"",MstrHspTip:"Bireysel",MstrTCN:"",MstrTelNo:"",OdaTipi:"",OdaYatak:"",KonaklamaSuresi:1,KonaklamaTipi:"GÜNLÜK",ToplamBedel:0,HesaplananBedel:0,OdemeVadesi:"",OdemeTakvimGunu:null,OtgCheckbox:!1}),b=c(!1),i=c(""),z=c(),y=c(!1),oe=c(),re=c(),Ue=c(),_=c(),G=c(),P=c(!1),p=c({kahvaltiDahil:!0,havluVerildi:!1,prizVerildi:!1,geceKonaklama:!1}),g=c({dahil:!0,bedel:0}),M=c(""),ie=c(new Date),Z=se(()=>{const e=ie.value,l=e.getDate().toString().padStart(2,"0"),s=(e.getMonth()+1).toString().padStart(2,"0"),d=e.getFullYear();return`${l}.${s}.${d}`}),J=se(()=>{const e=ie.value.getHours();return e>=0&&e<=4}),N=c(""),v=c(!1),E=c(!1),ue=c(""),t=c({MstrDgmTarihi:"",MstrTel2:"",MstrEposta:"",MstrMeslek:"",MstrYakini:"",MstrYknTel:"",MstrFirma:"",MstrVD:"",MstrVno:"",MstrFrmTel:"",MstrFrmMdr:"",MstrMdrTel:"",MstrAdres:"",MstrNot:""}),S=c([]),R=c([]),Y=c(null),ne=c([]),h=c([]),$e=se(()=>h.value),A=c(null),qe=se(()=>a.value.HesaplananBedel!==a.value.ToplamBedel),Q=c(!1),de=c(!1),O=c(null);async function me(){if(!a.value.OdaTipi||!a.value.KonaklamaSuresi||!a.value.KonaklamaTipi){a.value.HesaplananBedel=0,a.value.ToplamBedel=0;return}try{const e=await K.get(`/oda-tip-fiyatlari/${encodeURIComponent(a.value.OdaTipi)}`);if(e.data.success&&e.data.data){A.value=e.data.data;const l=Number(A.value?.OdDpzt)||0;g.value.bedel=l,console.log(`Depozito tutarı güncellendi: ${l} TL`);let s=0;const d=a.value.KonaklamaSuresi,m=a.value.KonaklamaTipi,r=Number(A.value?.OdLfytGun)||0,T=Number(A.value?.OdLfytHft)||0,w=Number(A.value?.OdLfytAyl)||0;m==="GÜNLÜK"?s=r*d:m==="1 HAFTALIK"?d>7?s=(d-7)*r+T:s=T:m==="2 HAFTALIK"?d>14?s=(d-14)*r+2*T:s=2*T:m==="3 HAFTALIK"?d>21?s=(d-21)*r+3*T:s=3*T:m==="AYLIK"&&(s=w),s>w?(s=w,console.log(`Bedel hesaplaması: ${m} hesaplandı ${s} TL, ama aylık fiyat uygulandı: ${w} TL`)):console.log(`Bedel hesaplaması: ${m} = ${s} TL`),s=Math.floor(s/10)*10,a.value.HesaplananBedel=s,a.value.ToplamBedel=s}}catch(e){console.error("Fiyat hesaplama hatası:",e),a.value.HesaplananBedel=0,a.value.ToplamBedel=0}}async function ve(){try{const e=await K.get("/firma-listesi");e.data.success&&(S.value=e.data.data,R.value=S.value.map(l=>({label:l,value:l})))}catch(e){console.error("Firma listesi yüklenemedi:",e)}}async function ce(){try{console.log("Boş oda tipleri yükleniyor...");const e=await K.get("/bos-oda-tipleri");console.log("Boş oda tipleri response:",e.data),e.data.success?(ne.value=e.data.data,console.log("Boş oda tipleri yüklendi:",ne.value)):console.error("Boş oda tipleri yüklenirken hata:",e.data)}catch(e){console.error("Boş oda tipleri yüklenemedi:",e)}}async function pe(e){try{if(console.log("Boş odalar yükleniyor, oda tipi:",e),!e){h.value=[];return}const l=await K.get(`/bos-odalar/${encodeURIComponent(e)}`);console.log("Boş odalar response:",l.data),l.data.success?(h.value=l.data.data,console.log("Boş odalar yüklendi:",h.value)):console.error("Boş odalar yüklenirken hata:",l.data)}catch(l){console.error("Boş odalar yüklenemedi:",l),h.value=[]}}function Pe(e,l){l(()=>{if(e==="")R.value=S.value.map(s=>({label:s,value:s}));else{const s=e.toLowerCase();R.value=S.value.filter(d=>d.toLowerCase().includes(s)).map(d=>({label:d,value:d}))}})}function Re(e){t.value.MstrFirma=e}function Qe(){const e=t.value.MstrFirma;e&&he(e)}async function he(e){if(!e||e.trim()===""){t.value.MstrVD="",t.value.MstrVno="",t.value.MstrFrmTel="",t.value.MstrFrmMdr="",t.value.MstrMdrTel="",Y.value=null;return}const l=e.trim();if(t.value.MstrFirma=l,!S.value.includes(l)){t.value.MstrVD="",t.value.MstrVno="",t.value.MstrFrmTel="",t.value.MstrFrmMdr="",t.value.MstrMdrTel="",Y.value=null;return}try{const s=await K.get(`/firma-detay/${encodeURIComponent(l)}`);if(s.data.success&&s.data.data){const d=s.data.data;t.value.MstrVD=d.MstrVD||"",t.value.MstrVno=d.MstrVno||"",t.value.MstrFrmTel=d.MstrFrmTel||"",t.value.MstrFrmMdr=d.MstrFrmMdr||"",t.value.MstrMdrTel=d.MstrMdrTel||"",Y.value={...d}}}catch(s){console.error("Firma detayları alınamadı:",s)}}async function j(){const e=t.value.MstrFirma;if(!(!e||!S.value.includes(e))&&Y.value&&(t.value.MstrVD!==(Y.value.MstrVD||"")||t.value.MstrVno!==(Y.value.MstrVno||"")||t.value.MstrFrmTel!==(Y.value.MstrFrmTel||"")||t.value.MstrFrmMdr!==(Y.value.MstrFrmMdr||"")||t.value.MstrMdrTel!==(Y.value.MstrMdrTel||"")))try{await K.post("/firma-guncelle",{firmaName:e,MstrVD:t.value.MstrVD,MstrVno:t.value.MstrVno,MstrFrmTel:t.value.MstrFrmTel,MstrFrmMdr:t.value.MstrFrmMdr,MstrMdrTel:t.value.MstrMdrTel}),Y.value={MstrVD:t.value.MstrVD,MstrVno:t.value.MstrVno,MstrFrmTel:t.value.MstrFrmTel,MstrFrmMdr:t.value.MstrFrmMdr,MstrMdrTel:t.value.MstrMdrTel}}catch(s){console.error("Firma bilgileri güncellenemedi:",s)}}ve(),ce(),Fe(),k(),D(()=>a.value.MstrHspTip,e=>{e==="Bireysel"?(t.value.MstrFirma="",t.value.MstrVD="",t.value.MstrVno="",t.value.MstrFrmTel="",t.value.MstrFrmMdr="",t.value.MstrMdrTel="",Y.value=null,v.value&&(t.value.MstrFirma="")):e==="Kurumsal"&&ve()}),D(()=>a.value.OdaTipi,e=>{if(E.value){console.log("Veri yükleniyor - onOdaTipiChanged atlandı");return}if(v.value){console.log("Güncelleme modunda - Oda tipi değişiklik kontrolleri atlandı");return}e?(a.value.OdaTipi=e,a.value.OdaYatak="",pe(e),xe(e),me()):(a.value.OdaTipi="",a.value.OdaYatak="",h.value=[],a.value.HesaplananBedel=0,a.value.ToplamBedel=0)}),D(()=>a.value.KonaklamaTipi,e=>{e==="GÜNLÜK"?p.value.kahvaltiDahil=!0:p.value.kahvaltiDahil=!1,k()}),D(()=>a.value.KonaklamaSuresi,e=>{(e>1||!J.value)&&(p.value.geceKonaklama=!1),k()}),D([()=>a.value.HesaplananBedel,()=>a.value.ToplamBedel],()=>{v.value||k(),a.value.HesaplananBedel===a.value.ToplamBedel&&a.value.HesaplananBedel>0&&a.value.OtgCheckbox&&(console.log("🔥 Ö.T.G. otomatik temizleniyor - Bedeller eşitlendi:",{hesaplananBedel:a.value.HesaplananBedel,toplamBedel:a.value.ToplamBedel}),a.value.OtgCheckbox=!1,console.log("🔥 Ö.T.G. checkbox otomatik temizlendi - (ÖTG) ifadesi ek notlarda korundu"))}),D(()=>p.value,()=>{k()},{deep:!0}),D(()=>g.value,()=>{k()},{deep:!0}),D(()=>J.value,e=>{!e&&p.value.geceKonaklama&&(p.value.geceKonaklama=!1,k())});let ee=null;Te(async()=>{console.log("Musteri-islem sayfası yüklendi"),M.value="",a.value.OdemeVadesi=Z.value,await Se(),await ce(),ve(),ee=setInterval(()=>{ie.value=new Date},6e4),setTimeout(()=>{console.log("🔥 Test: updateEkNotlar çağrılıyor"),k()},2e3)});async function je(){if(b.value=!0,i.value="",v.value){if(!a.value.MstrTCN){i.value="TC Kimlik No / Pasaport No zorunludur",b.value=!1;return}if(!a.value.MstrTelNo){i.value="Telefon No zorunludur",b.value=!1;return}if(!a.value.MstrAdi){i.value="Müşteri Adı zorunludur",b.value=!1;return}if(a.value.MstrHspTip==="Kurumsal"&&!t.value.MstrFirma){i.value="Firma seçimi zorunludur",b.value=!1;return}if(!a.value.OdemeVadesi||a.value.OdemeVadesi.trim()===""){i.value="Ödeme Vadesi zorunludur",b.value=!1;return}try{const e={...t.value,MstrAdi:a.value.MstrAdi,MstrTelNo:a.value.MstrTelNo,MstrHspTip:a.value.MstrHspTip},l=await K.post(`/musteri-guncelle/${a.value.MstrTCN}`,e);l.data.success?(i.value=l.data.message||"Müşteri bilgileri başarıyla güncellendi!",setTimeout(()=>{i.value="",fe()},3e3)):i.value="Güncelleme sırasında hata oluştu!"}catch(e){console.error("Güncelleme hatası:",e),Me(e)&&e.response&&e.response.data&&typeof e.response.data=="object"&&"message"in e.response.data&&typeof e.response.data.message=="string"?i.value=e.response.data.message:e instanceof Error&&typeof e.message=="string"?i.value=e.message:i.value="Güncelleme sırasında hata oluştu!"}finally{b.value=!1}return}if(!a.value.MstrTCN){i.value="TC Kimlik No / Pasaport No zorunludur",b.value=!1;return}if(!a.value.MstrTelNo){i.value="Telefon No zorunludur",b.value=!1;return}if(!a.value.MstrAdi){i.value="Müşteri Adı zorunludur",b.value=!1;return}if(!a.value.OdaTipi){i.value="Oda Tipi seçimi zorunludur",b.value=!1;return}if(!a.value.OdaYatak){i.value="Oda No - Yatak No seçimi zorunludur",b.value=!1;return}if(a.value.MstrHspTip==="Kurumsal"&&!t.value.MstrFirma){i.value="Firma seçimi zorunludur",b.value=!1;return}if(!a.value.OdemeVadesi||a.value.OdemeVadesi.trim()===""){i.value="Ödeme Vadesi zorunludur",b.value=!1;return}if(a.value.KonaklamaSuresi===30&&(!a.value.OdemeTakvimGunu||a.value.OdemeTakvimGunu<1||a.value.OdemeTakvimGunu>31)){i.value="Konaklama süresi 30 gün iken Ö.T.G. (1-31 arası) zorunludur",b.value=!1;return}try{const e=localStorage.getItem("username")||"admin",l={...a.value,...t.value,MstrKllnc:e,MstrDurum:"KALIYOR",ekNotlar:M.value,ekHizmetler:p.value,depozito:g.value},s=await K.post("/musteri-islem",l);s.data.success?(i.value=s.data.message||"Kayıt başarıyla eklendi!",a.value={MstrAdi:"",MstrHspTip:"Bireysel",MstrTCN:"",MstrTelNo:"",OdaTipi:"",OdaYatak:"",KonaklamaSuresi:1,KonaklamaTipi:"GÜNLÜK",ToplamBedel:0,HesaplananBedel:0,OdemeVadesi:Z.value,OdemeTakvimGunu:null,OtgCheckbox:!1},t.value={MstrDgmTarihi:"",MstrTel2:"",MstrEposta:"",MstrMeslek:"",MstrYakini:"",MstrYknTel:"",MstrFirma:"",MstrVD:"",MstrVno:"",MstrFrmTel:"",MstrFrmMdr:"",MstrMdrTel:"",MstrAdres:"",MstrNot:""},p.value={kahvaltiDahil:!0,havluVerildi:!1,prizVerildi:!1,geceKonaklama:!1},g.value={dahil:!0,bedel:0},M.value="",N.value="",v.value=!1,h.value=[],y.value=!1,setTimeout(()=>{i.value=""},3e3)):i.value="Kayıt sırasında hata oluştu!"}catch(e){if(console.error("Error:",e),Me(e)&&e.response&&e.response.data&&typeof e.response.data=="object"&&"message"in e.response.data&&typeof e.response.data.message=="string"){const l=e.response.data.message;i.value=l,(l.includes("artık dolu")||l.includes("bulunamadı"))&&await Ae()}else Me(e)&&e.response&&e.response.data&&typeof e.response.data=="object"&&"error"in e.response.data&&typeof e.response.data.error=="string"?(i.value=e.response.data.error,(e.response.data.error.includes("artık dolu")||e.response.data.error.includes("bulunamadı"))&&await Ae()):e instanceof Error&&typeof e.message=="string"?i.value=e.message:i.value="Kayıt sırasında hata oluştu!"}finally{b.value=!1}}function fe(){a.value={MstrAdi:"",MstrHspTip:"Bireysel",MstrTCN:"",MstrTelNo:"",OdaTipi:"",OdaYatak:"",KonaklamaSuresi:1,KonaklamaTipi:"GÜNLÜK",ToplamBedel:0,HesaplananBedel:0,OdemeVadesi:Z.value,OdemeTakvimGunu:null,OtgCheckbox:!1},t.value={MstrDgmTarihi:"",MstrTel2:"",MstrEposta:"",MstrMeslek:"",MstrYakini:"",MstrYknTel:"",MstrFirma:"",MstrVD:"",MstrVno:"",MstrFrmTel:"",MstrFrmMdr:"",MstrMdrTel:"",MstrAdres:"",MstrNot:""},p.value={kahvaltiDahil:!0,havluVerildi:!1,prizVerildi:!1,geceKonaklama:!1},g.value={dahil:!0,bedel:0},M.value="",N.value="",v.value=!1,E.value=!1,y.value=!1,h.value=[],i.value=""}function We(){y.value=!y.value}function Xe(){P.value=!1;const e=[];g.value.dahil&&e.push(`Depozito: ${g.value.bedel}₺`),p.value.kahvaltiDahil&&e.push("Kahvaltı Dahil"),p.value.havluVerildi&&e.push("Havlu Verildi"),p.value.prizVerildi&&e.push("Priz Verildi"),p.value.geceKonaklama&&e.push("Geç Saat Konaklama"),k()}function Ze(){p.value={kahvaltiDahil:a.value.KonaklamaTipi==="GÜNLÜK",havluVerildi:!1,prizVerildi:!1,geceKonaklama:!1},g.value.dahil=!0,P.value=!1}function k(){if(console.log("🔥 updateEkNotlar çağrıldı"),v.value){console.log("🔥 Güncelleme modunda - ek notlar güncellenmedi");return}const e=M.value||"",l=e.includes("(ÖTG)")?"(ÖTG) ":"",s=[];if(N.value==="AYRILAN_MUSTERI"?s.push("Yeni Giriş:"):N.value==="YENI"&&s.push("Yeni Müşteri:"),g.value.dahil&&g.value.bedel>0?s.push(`Depozito: ${g.value.bedel}₺`):g.value.dahil||s.push("Depozito Alınmadı"),a.value.HesaplananBedel>0&&a.value.ToplamBedel>0){const m=a.value.HesaplananBedel,r=a.value.ToplamBedel;if(r<m){const T=Math.round((m-r)/m*100);s.push(`${l}İskonto Yapıldı: %${T}`)}else if(r>m){const T=Math.round((r-m)/m*100);s.push(`${l}Artış Yapıldı: %${T}`)}}a.value.KonaklamaTipi==="GÜNLÜK"&&!p.value.kahvaltiDahil&&s.push("Kahvaltısız"),p.value.havluVerildi&&s.push("Havlu Verildi"),p.value.prizVerildi&&s.push("Priz Verildi"),p.value.geceKonaklama&&s.push("Geç Saat Konaklama");const d=s.length>0?" - "+s.join(" -/- "):"";M.value=d,console.log("🔥 Ek notlar güncellendi:",{notlar:s,finalNotlar:d,otgPrefix:l?"Korundu":"Yok",mevcutNotlar:e})}function Je(e){t.value.MstrDgmTarihi=e,oe.value&&oe.value.hide()}function ea(e){a.value.OdemeVadesi=e,re.value&&re.value.hide()}function aa(){ue.value=a.value.MstrTCN||""}function la(){if(a.value.MstrAdi||a.value.MstrTelNo||a.value.OdaTipi||a.value.OdaYatak||t.value.MstrDgmTarihi||t.value.MstrTel2||t.value.MstrEposta||t.value.MstrMeslek||t.value.MstrYakini||t.value.MstrYknTel||t.value.MstrFirma||t.value.MstrAdres||t.value.MstrNot||v.value){const l=a.value.MstrTCN;fe(),a.value.MstrTCN=l,i.value="Form temizlendi - Yeni TC kimlik kontrolü için alanı terk edin",setTimeout(()=>{i.value=""},2500)}}async function Ke(){const e=a.value.MstrTCN?.trim()||"";e&&e.length>=5&&await sa(e),e!==ue.value&&(a.value.MstrAdi||a.value.MstrTelNo||a.value.MstrHspTip||a.value.OdaTipi||a.value.OdaYatak||t.value.MstrDgmTarihi||t.value.MstrTel2||t.value.MstrEposta||t.value.MstrMeslek||t.value.MstrYakini||t.value.MstrYknTel||t.value.MstrFirma||t.value.MstrAdres||t.value.MstrNot||M.value||v.value)&&(a.value.MstrAdi="",a.value.MstrTelNo="",a.value.MstrHspTip="Bireysel",a.value.OdaTipi="",a.value.OdaYatak="",a.value.KonaklamaSuresi=1,a.value.KonaklamaTipi="GÜNLÜK",a.value.ToplamBedel=0,a.value.HesaplananBedel=0,a.value.OdemeTakvimGunu=null,t.value={MstrDgmTarihi:"",MstrTel2:"",MstrEposta:"",MstrMeslek:"",MstrYakini:"",MstrYknTel:"",MstrFirma:"",MstrVD:"",MstrVno:"",MstrFrmTel:"",MstrFrmMdr:"",MstrMdrTel:"",MstrAdres:"",MstrNot:""},p.value={kahvaltiDahil:!0,havluVerildi:!1,prizVerildi:!1,geceKonaklama:!1},g.value={dahil:!0,bedel:0},M.value="",y.value=!1,N.value="",v.value=!1,h.value=[],i.value="TC değişikliği algılandı - Form temizlendi",setTimeout(()=>{i.value=""},2500));const l=e;if(!l||l.length<5){N.value="",v.value=!1;return}try{const s=await K.get(`/musteri-durum-kontrol/${l}`);if(s.data.success&&s.data.data){const d=s.data.data;if(!d.exists)N.value="YENI",v.value=!1,i.value="",M.value="Yeni Müşteri: ";else if(d.durum==="AYRILDI"){N.value="AYRILAN_MUSTERI",v.value=!1,i.value="Müşteri daha önce kayıtlı ancak ayrılmış - Bilgiler yükleniyor...",M.value="Yeni Giriş: ";try{const m=await K.get(`/musteri-bilgi/${l}`);if(m.data.success&&m.data.data){const r=m.data.data;a.value.MstrAdi=r.MstrAdi||"",a.value.MstrTelNo=r.MstrTelNo||"",a.value.MstrHspTip=r.MstrHspTip||"Bireysel",t.value.MstrDgmTarihi=r.MstrDgmTarihi||"",t.value.MstrTel2=r.MstrTel2||"",t.value.MstrEposta=r.MstrEposta||"",t.value.MstrMeslek=r.MstrMeslek||"",t.value.MstrYakini=r.MstrYakini||"",t.value.MstrYknTel=r.MstrYknTel||"",t.value.MstrAdres=r.MstrAdres||"",t.value.MstrNot=r.MstrNot||"",r.MstrHspTip==="Kurumsal"&&(t.value.MstrFirma=r.MstrFirma||"",t.value.MstrVD=r.MstrVD||"",t.value.MstrVno=r.MstrVno||"",t.value.MstrFrmTel=r.MstrFrmTel||"",t.value.MstrFrmMdr=r.MstrFrmMdr||"",t.value.MstrMdrTel=r.MstrMdrTel||""),i.value="Ayrılmış müşteri bilgileri yüklendi"}}catch(m){console.error("Müşteri bilgileri alınamadı:",m),i.value="Ayrılmış müşteri bilgileri alınamadı"}setTimeout(()=>{i.value=""},3e3)}else if(d.durum==="KALIYOR"){N.value="KALIYOR",v.value=!0,i.value="Güncelleme moduna geçiliyor - Mevcut konaklama bilgileri yükleniyor...";try{E.value=!0;const m=await K.get(`/mevcut-konaklama/${l}`);if(m.data.success&&m.data.data){const r=m.data.data;if(a.value.MstrAdi=r.MstrAdi||"",a.value.MstrTelNo=r.MstrTelNo||"",a.value.MstrHspTip=r.MstrHspTip||"Bireysel",a.value.OdaTipi=r.KnklmOdaTip||"",a.value.OdaYatak=`Oda: ${r.KnklmOdaNo} - Yatak: ${r.KnklmYtkNo}`,a.value.KonaklamaTipi=r.KnklmTip||"GÜNLÜK",r.KnklmGrsTrh&&r.KnklmPlnTrh){const w=new Date(r.KnklmGrsTrh.split(".").reverse().join("-")),pa=new Date(r.KnklmPlnTrh.split(".").reverse().join("-")),fa=Math.abs(pa.getTime()-w.getTime()),De=Math.ceil(fa/(1e3*60*60*24));a.value.KonaklamaSuresi=De>0?De:1}else a.value.KonaklamaSuresi=1;a.value.ToplamBedel=parseFloat(r.KnklmNfyt)||0,a.value.HesaplananBedel=parseFloat(r.KnklmLfyt)||0,M.value=r.KnklmNot||"";const T=await K.get(`/musteri-odeme-vadesi/${l}`);T.data.success&&T.data.odemeVadesi?a.value.OdemeVadesi=T.data.odemeVadesi:a.value.OdemeVadesi=Z.value,t.value.MstrDgmTarihi=r.MstrDgmTarihi||"",t.value.MstrTel2=r.MstrTel2||"",t.value.MstrEposta=r.MstrEposta||"",t.value.MstrMeslek=r.MstrMeslek||"",t.value.MstrYakini=r.MstrYakini||"",t.value.MstrYknTel=r.MstrYknTel||"",t.value.MstrAdres=r.MstrAdres||"",t.value.MstrNot=r.MstrNot||"",r.MstrHspTip==="Kurumsal"&&(t.value.MstrFirma=r.MstrFirma||"",t.value.MstrVD=r.MstrVD||"",t.value.MstrVno=r.MstrVno||"",t.value.MstrFrmTel=r.MstrFrmTel||"",t.value.MstrFrmMdr=r.MstrFrmMdr||"",t.value.MstrMdrTel=r.MstrMdrTel||""),y.value=!0,i.value="Güncelleme modu - Mevcut konaklama bilgileri yüklendi",setTimeout(()=>{E.value=!1,console.log("Veri yükleme tamamlandı - watchers tekrar aktif")},100)}}catch(m){console.error("Mevcut konaklama bilgileri alınamadı:",m),i.value="Güncelleme modu - Konaklama bilgileri alınamadı",E.value=!1}setTimeout(()=>{i.value=""},3e3)}else console.warn("Beklenmeyen müşteri durumu:",d.durum),N.value="YENI",v.value=!1,i.value=""}else N.value="YENI",v.value=!1}catch(s){console.error("TC kimlik kontrolü hatası:",s),N.value="YENI",v.value=!1}k()}async function sa(e){try{console.log("🚨 Kara liste kontrolü başlatılıyor:",e);const l=await K.get(`/dashboard/kara-liste-kontrol/${e}`);if(l.data.success&&l.data.data){const s=l.data.data;s.isKaraListe&&(console.log("🚨 KARA LİSTE MÜŞTERİSİ TESPİT EDİLDİ!"),O.value={MstrTCN:e,MstrAdi:s.musteriAdi||"Bilinmiyor",MstrTelNo:s.musteriTelNo||"",MstrFirma:s.musteriFirma||"",KnklmNot:s.karaListeNot||"",knklmNo:s.knklmNo},Q.value=!0)}}catch(l){console.error("Kara liste kontrolü hatası:",l)}}async function ta(){if(O.value?.MstrTCN){de.value=!0;try{const e=await K.put(`/dashboard/kara-listeden-cikar/${O.value.MstrTCN}`);if(e.data.success)i.value="✅ Müşteri kara listeden başarıyla çıkarıldı. İşleme devam edebilirsiniz.",Q.value=!1,O.value=null,setTimeout(()=>{i.value=""},3e3);else throw new Error(e.data.message||"Kara listeden çıkarma işlemi başarısız")}catch(e){console.error("Kara listeden çıkarma hatası:",e);const l=e instanceof Error?e.message||"Sunucu hatası":"Bilinmeyen hata";i.value=`❌ Hata: ${l}`,setTimeout(()=>{i.value=""},5e3)}finally{de.value=!1}}}function oa(){Q.value=!1,O.value=null,a.value.MstrAdi="",a.value.MstrHspTip="Bireysel",a.value.MstrTCN="",a.value.MstrTelNo="",a.value.OdaTipi="",a.value.OdaYatak="",a.value.KonaklamaSuresi=1,a.value.KonaklamaTipi="GÜNLÜK",a.value.ToplamBedel=0,a.value.HesaplananBedel=0,a.value.OdemeTakvimGunu=null,t.value={MstrDgmTarihi:"",MstrTel2:"",MstrEposta:"",MstrMeslek:"",MstrYakini:"",MstrYknTel:"",MstrFirma:"",MstrVD:"",MstrVno:"",MstrFrmTel:"",MstrFrmMdr:"",MstrMdrTel:"",MstrAdres:"",MstrNot:""},p.value={kahvaltiDahil:!0,havluVerildi:!1,prizVerildi:!1,geceKonaklama:!1},g.value={dahil:!0,bedel:0},M.value="",y.value=!1,N.value="",v.value=!1,h.value=[],R.value=[],A.value=null,ue.value="",i.value="❌ İşlem iptal edildi. Tüm form alanları temizlendi.",setTimeout(()=>{i.value=""},3e3),z.value&&z.value.focus()}let ke=!1;const ae={x:0,y:0};function ra(e){ke=!0;const l=e.target.closest(".draggable-card")?.getBoundingClientRect();l&&(ae.x=e.clientX-l.left,ae.y=e.clientY-l.top),document.addEventListener("mousemove",Oe),document.addEventListener("mouseup",Ne),e.preventDefault()}function Oe(e){if(!ke)return;const l=document.querySelector(".draggable-card");if(l){const s=e.clientX-ae.x,d=e.clientY-ae.y;l.style.position="fixed",l.style.left=`${Math.max(0,Math.min(s,window.innerWidth-l.offsetWidth))}px`,l.style.top=`${Math.max(0,Math.min(d,window.innerHeight-l.offsetHeight))}px`,l.style.transform="none"}}function Ne(){ke=!1,document.removeEventListener("mousemove",Oe),document.removeEventListener("mouseup",Ne)}function ia(e){if(E.value){console.log("Veri yükleniyor - onOdaTipiChanged atlandı");return}if(v.value){console.log("Güncelleme modunda - Oda tipi değişiklik kontrolleri atlandı");return}e?(a.value.OdaTipi=e,a.value.OdaYatak="",pe(e),xe(e),me(),k()):(a.value.OdaTipi="",a.value.OdaYatak="",h.value=[],a.value.HesaplananBedel=0,a.value.ToplamBedel=0,k())}function ua(e){if(v.value){console.log("Güncelleme modunda - Oda-yatak değişiklik kontrolleri atlandı");return}e&&(a.value.OdaYatak=e,ca(e),k())}function na(){const e=a.value.OdemeTakvimGunu;if(v.value){console.log("Güncelleme modunda - Ödeme takvim günü değişikliği atlandı");return}if(e&&(e<1||e>31)){a.value.OdemeTakvimGunu=null,i.value="Ödeme takvim günü 1-31 arasında olmalıdır.",setTimeout(()=>{i.value=""},3e3);return}console.log("Ödeme takvim günü güncellendi:",e)}async function Fe(){if(v.value){console.log("Güncelleme modunda - Konaklama süresi hesaplamaları atlandı");return}const e=a.value.KonaklamaSuresi;if(e===30&&a.value.OdemeTakvimGunu===null){const w=new Date().getDate();a.value.OdemeTakvimGunu=w,console.log("Ö.T.G. default değer ayarlandı:",w)}else e!==30&&(a.value.OdemeTakvimGunu=null);if(e<1||e>30){a.value.KonaklamaSuresi=1,a.value.KonaklamaTipi="GÜNLÜK",a.value.OdemeTakvimGunu=null;return}if(!A.value&&a.value.OdaTipi)try{const T=await K.get(`/oda-tip-fiyatlari/${encodeURIComponent(a.value.OdaTipi)}`);T.data.success&&T.data.data&&(A.value=T.data.data)}catch(T){console.error("Fiyat bilgileri alınamadı:",T),a.value.KonaklamaTipi="GÜNLÜK";return}if(!A.value){a.value.KonaklamaTipi="GÜNLÜK";return}const l=Number(A.value.OdLfytGun)||0,s=Number(A.value.OdLfytHft)||0,d=Number(A.value.OdLfytAyl)||0;console.log("Fiyat analizi:",{sure:e,gunlukFiyat:l,haftalikFiyat:s,aylikFiyat:d});let m="",r=0;e<=7&&e*l<=s?(m="GÜNLÜK",r=e*l,console.log("Günlük seçildi:",{gunlukToplam:r,haftalikFiyat:s})):e>7&&e<=14&&(e-7)*l+s<=2*s?(m="1 HAFTALIK",r=(e-7)*l+s,console.log("1 Haftalık seçildi:",{hesaplanan:r,ikiHaftalik:2*s})):e>14&&e<=21&&(e-14)*l+2*s<=3*s?(m="2 HAFTALIK",r=(e-14)*l+2*s,console.log("2 Haftalık seçildi:",{hesaplanan:r,ucHaftalik:3*s})):e>21&&(e-21)*l+3*s<=d?(m="3 HAFTALIK",r=(e-21)*l+3*s,console.log("3 Haftalık seçildi:",{hesaplanan:r,aylikFiyat:d})):e<=7?(m="1 HAFTALIK",r=s,console.log("1 Haftalık seçildi (6-7 gün için):",{gunlukToplam:e*l,haftalikFiyat:s})):e<=14?(m="2 HAFTALIK",r=2*s,console.log("2 Haftalık seçildi (backup):",{sure:e,hesaplanan:r})):e<=21?(m="3 HAFTALIK",r=3*s,console.log("3 Haftalık seçildi (backup):",{sure:e,hesaplanan:r})):(m="AYLIK",r=d,console.log("Aylık seçildi:",{sure:e,aylikFiyat:d})),r>d?(a.value.KonaklamaTipi="AYLIK",console.log("Aylık fiyat sınırı aşıldı, aylık seçildi:",{hesaplananTutar:r,aylikFiyat:d})):a.value.KonaklamaTipi=m,me(),k()}function da(e){typeof e=="number"&&e>=0?a.value.ToplamBedel=e:typeof e=="string"&&!isNaN(Number(e))?a.value.ToplamBedel=Number(e):a.value.ToplamBedel=0,k()}function ma(e){if(console.log("Ö.T.G. checkbox değişti:",e),e){const l=M.value||"";a.value.HesaplananBedel!==a.value.ToplamBedel&&(l.includes("İskonto Yapıldı:")?M.value=l.replace("İskonto Yapıldı:","(ÖTG) İskonto Yapıldı:"):l.includes("Artış Yapıldı:")?M.value=l.replace("Artış Yapıldı:","(ÖTG) Artış Yapıldı:"):l.trim()===""&&(a.value.ToplamBedel>a.value.HesaplananBedel?M.value="(ÖTG) Artış Yapıldı: %"+Math.round((a.value.ToplamBedel-a.value.HesaplananBedel)/a.value.HesaplananBedel*100):M.value="(ÖTG) İskonto Yapıldı: %"+Math.round((a.value.HesaplananBedel-a.value.ToplamBedel)/a.value.HesaplananBedel*100)))}else{const l=M.value||"";l.includes("(ÖTG)")&&(M.value=l.replace("(ÖTG) İskonto Yapıldı:","İskonto Yapıldı:").replace("(ÖTG) Artış Yapıldı:","Artış Yapıldı:"))}}function va(){if(!a.value.OdaYatak)return"";const e=h.value.find(l=>l.value===a.value.OdaYatak);return e?`Seçilen: ${e.label}`:""}function xe(e){i.value=`✓ ${e} oda tipi seçildi. Boş odalar yükleniyor...`,setTimeout(()=>{h.value.length>0?i.value=`✓ ${h.value.length} adet boş oda bulundu.`:i.value=`⚠ ${e} için boş oda bulunamadı.`,setTimeout(()=>{i.value=""},3e3)},1500)}function ca(e){const l=h.value.find(s=>s.value===e);l&&(i.value=`✓ ${l.label} seçildi!`,setTimeout(()=>{i.value=""},2500))}async function Ae(){if(a.value.OdaYatak="",a.value.OdaTipi)try{await pe(a.value.OdaTipi),console.log("Oda-yatak listesi güncellendi")}catch(e){console.error("Oda listesi güncellenirken hata:",e)}}function le(){we(()=>{_.value&&G.value&&y.value?(G.value.style.height="auto",setTimeout(()=>{if(_.value&&G.value){const e=_.value.offsetHeight;G.value.style.height=`${e}px`,console.log("Container yükseklikleri senkronize edildi:",{anaHeight:e})}},50)):G.value&&!y.value&&(G.value.style.height="auto")})}let W=null;function Ye(){typeof ResizeObserver<"u"&&_.value&&(W=new ResizeObserver(()=>{y.value&&le()}),W.observe(_.value))}function Be(){W&&(W.disconnect(),W=null)}Te(()=>{le(),Ye()}),Te(async()=>{await ce()}),Ma(()=>{Be(),ee&&(clearInterval(ee),ee=null)}),D(y,()=>{le(),y.value?Ye():Be()}),D([()=>a.value.MstrHspTip,()=>a.value.OdaTipi,()=>a.value.KonaklamaSuresi,()=>i.value],()=>{y.value&&setTimeout(()=>le(),100)},{flush:"post"});function Me(e){return e.isAxiosError===!0}return(e,l)=>(F(),L(Ka,{class:"q-pa-md light-page-background"},{default:n(()=>[l[54]||(l[54]=u("div",{class:"text-h6 q-mb-md text-center"},"Müşteri İşlemleri Formu",-1)),u("div",Na,[u("div",Fa,[u("div",xa,[u("div",Aa,[o(Ce(ha),{onSubmit:l[22]||(l[22]=ga(()=>{},["prevent"])),class:"q-gutter-xs",ref_key:"formRef",ref:Ue},{default:n(()=>[u("div",{class:"ana-form-container",ref_key:"anaContainerRef",ref:_},[u("div",Ya,[u("div",Ba,[l[40]||(l[40]=u("label",{class:"text-subtitle2 text-grey-8 q-mb-sm block"},"Hesap Tipi",-1)),o(Ta,{modelValue:a.value.MstrHspTip,"onUpdate:modelValue":l[0]||(l[0]=s=>a.value.MstrHspTip=s),options:Ie,color:"primary",inline:"",dense:""},null,8,["modelValue"])]),u("div",Da,[o(H,{onClick:We,round:"",class:"toggle-btn"},{default:n(()=>[o(C,{name:y.value?"chevron_left":"chevron_right",class:"toggle-icon"},null,8,["name"]),o(X,{class:"bg-grey-8 text-white text-body2",delay:500},{default:n(()=>[V(x(y.value?"Ek Bilgileri Gizle":"Ek Bilgileri Göster"),1)]),_:1})]),_:1})])]),a.value.MstrHspTip==="Kurumsal"?(F(),I("div",wa,[u("div",Ca,[u("div",Ha,[o(Ve,{modelValue:t.value.MstrFirma,"onUpdate:modelValue":[l[1]||(l[1]=s=>t.value.MstrFirma=s),he],label:"Firma",outlined:"",color:"orange-4","label-color":"orange-4",dense:"",class:"kurumsal-responsive","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",options:R.value,onFilter:Pe,onInputValue:Re,onBlur:Qe,required:"","new-value-mode":"add-unique","option-value":"value","option-label":"label","emit-value":"","map-options":"","options-dense":"","popup-content-class":"firma-dropdown-options"},{"no-option":n(()=>[o($,{dense:""},{default:n(()=>[o(q,{class:"text-grey"},{default:n(()=>l[41]||(l[41]=[V(" Mevcut firmaları görmek için yazmaya başlayın ")])),_:1,__:[41]})]),_:1})]),option:n(s=>[o($,ge(s.itemProps,{dense:"",class:"q-py-xs"}),{default:n(()=>[o(q,null,{default:n(()=>[o(ye,{class:"text-body2"},{default:n(()=>[V(x(s.opt.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options"]),o(f,{modelValue:t.value.MstrVD,"onUpdate:modelValue":[l[2]||(l[2]=s=>t.value.MstrVD=s),j],label:"Vergi Dairesi",outlined:"",color:"orange-4","label-color":"orange-4",dense:"",class:"kurumsal-responsive"},null,8,["modelValue"]),o(f,{modelValue:t.value.MstrFrmMdr,"onUpdate:modelValue":[l[3]||(l[3]=s=>t.value.MstrFrmMdr=s),j],label:"Firma Müdür",outlined:"",color:"orange-4","label-color":"orange-4",dense:"",class:"kurumsal-responsive"},null,8,["modelValue"])]),u("div",za,[o(f,{modelValue:t.value.MstrFrmTel,"onUpdate:modelValue":[l[4]||(l[4]=s=>t.value.MstrFrmTel=s),j],label:"Firma Tel",outlined:"",color:"orange-4","label-color":"orange-4",dense:"",class:"kurumsal-responsive"},null,8,["modelValue"]),o(f,{modelValue:t.value.MstrVno,"onUpdate:modelValue":[l[5]||(l[5]=s=>t.value.MstrVno=s),j],label:"Vergi No",outlined:"",color:"orange-4","label-color":"orange-4",dense:"",class:"kurumsal-responsive"},null,8,["modelValue"]),o(f,{modelValue:t.value.MstrMdrTel,"onUpdate:modelValue":[l[6]||(l[6]=s=>t.value.MstrMdrTel=s),j],label:"Müdür Tel",outlined:"",color:"orange-4","label-color":"orange-4",dense:"",class:"kurumsal-responsive"},null,8,["modelValue"])])])])):B("",!0),u("div",Ga,[u("div",La,[u("div",_a,[o(f,{ref_key:"tcInput",ref:z,modelValue:a.value.MstrTCN,"onUpdate:modelValue":l[7]||(l[7]=s=>a.value.MstrTCN=s),label:"TC Kimlik No / Pasaport No",required:"",dense:"",outlined:"",color:"primary","label-color":"primary",class:"kurumsal-responsive",onFocus:aa,onInput:la,onBlur:Ke},null,8,["modelValue"])]),u("div",Ea,[o(f,{modelValue:a.value.MstrTelNo,"onUpdate:modelValue":[l[8]||(l[8]=s=>a.value.MstrTelNo=s),k],label:"Telefon No",color:"primary","label-color":"primary",dense:"",outlined:"",required:"",class:"kurumsal-responsive"},null,8,["modelValue"])])]),u("div",Sa,[u("div",Ia,[o(f,{modelValue:a.value.MstrAdi,"onUpdate:modelValue":[l[9]||(l[9]=s=>a.value.MstrAdi=s),k],label:"Müşteri Adı",required:"",dense:"",outlined:"",color:"primary","label-color":"primary",class:"kurumsal-responsive"},null,8,["modelValue"])])])]),u("div",Ua,[u("div",$a,[u("div",qa,[o(Ve,{modelValue:a.value.OdaTipi,"onUpdate:modelValue":[l[10]||(l[10]=s=>a.value.OdaTipi=s),ia],options:ne.value,label:"Oda Tipi",outlined:"",dense:"",color:"green-6","label-color":"green-6",required:"",readonly:v.value,disable:v.value,class:"kurumsal-responsive oda-select-field",style:{"font-size":"0.75rem"}},{"no-option":n(()=>[o($,{dense:""},{default:n(()=>[o(q,{class:"text-grey"},{default:n(()=>l[42]||(l[42]=[V(" Oda tipi bulunamadı ")])),_:1,__:[42]})]),_:1})]),option:n(s=>[o($,ge(s.itemProps,{style:{"min-height":"28px",padding:"2px 12px"}}),{default:n(()=>[o(q,null,{default:n(()=>[o(ye,{style:{"font-size":"0.75rem","line-height":"1.1"}},{default:n(()=>[V(x(s.opt),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),default:n(()=>[a.value.OdaTipi?(F(),L(X,{key:0,class:"bg-green-6 text-white text-body2",delay:300},{default:n(()=>[o(C,{name:"info",class:"q-mr-xs"}),V(" Seçilen oda tipi: "+x(a.value.OdaTipi),1)]),_:1})):B("",!0)]),_:1},8,["modelValue","options","readonly","disable"])]),u("div",Pa,[o(Ve,{modelValue:a.value.OdaYatak,"onUpdate:modelValue":[l[11]||(l[11]=s=>a.value.OdaYatak=s),ua],options:$e.value,label:"Oda No - Yatak No",outlined:"",dense:"",color:"green-6","label-color":"green-6",disable:!a.value.OdaTipi||v.value,readonly:v.value,required:"",class:"kurumsal-responsive oda-select-field",style:{"font-size":"0.75rem"}},{"no-option":n(()=>[o($,{dense:""},{default:n(()=>[o(q,{class:"text-grey"},{default:n(()=>[V(x(a.value.OdaTipi?"Boş oda/yatak bulunamadı":"Önce oda tipi seçin"),1)]),_:1})]),_:1})]),option:n(s=>[o($,ge(s.itemProps,{style:{"min-height":"28px",padding:"2px 12px"}}),{default:n(()=>[o(q,null,{default:n(()=>[o(ye,{style:{"font-size":"0.75rem","line-height":"1.1"},title:s.opt.label},{default:n(()=>[V(x(s.opt.label),1)]),_:2},1032,["title"])]),_:2},1024)]),_:2},1040)]),default:n(()=>[a.value.OdaYatak?(F(),L(X,{key:0,class:"bg-green-6 text-white text-body2",delay:300},{default:n(()=>[o(C,{name:"check_circle",class:"q-mr-xs"}),V(" "+x(va()),1)]),_:1})):B("",!0)]),_:1},8,["modelValue","options","disable","readonly"])])]),u("div",Ra,[u("div",Qa,[o(f,{modelValue:a.value.KonaklamaSuresi,"onUpdate:modelValue":[l[12]||(l[12]=s=>a.value.KonaklamaSuresi=s),Fe],modelModifiers:{number:!0},label:"Konaklama Süresi (Gün)",outlined:"",color:"green-6","label-color":"green-6",dense:"",type:"number",min:1,max:30,required:"",readonly:v.value,disable:v.value,class:"kurumsal-responsive konaklama-field"},null,8,["modelValue","readonly","disable"])]),u("div",ja,[o(f,{modelValue:a.value.KonaklamaTipi,"onUpdate:modelValue":l[13]||(l[13]=s=>a.value.KonaklamaTipi=s),label:"Konaklama Tipi",outlined:"",color:"green-6","label-color":"green-6",dense:"",readonly:"",class:be(["kurumsal-responsive konaklama-field konaklama-readonly",{"text-weight-medium":a.value.KonaklamaTipi}])},null,8,["modelValue","class"])]),a.value.KonaklamaSuresi===30?(F(),I("div",Wa,[o(f,{modelValue:a.value.OdemeTakvimGunu,"onUpdate:modelValue":[l[14]||(l[14]=s=>a.value.OdemeTakvimGunu=s),na],modelModifiers:{number:!0},label:"Ö.T.G.",outlined:"",color:"green-6","label-color":"green-6",dense:"",type:"number",min:1,max:31,readonly:"",disable:"",class:"kurumsal-responsive konaklama-field"},null,8,["modelValue"])])):B("",!0)])]),u("div",Xa,[u("div",Za,[u("div",Ja,[o(f,{modelValue:a.value.HesaplananBedel,"onUpdate:modelValue":l[15]||(l[15]=s=>a.value.HesaplananBedel=s),modelModifiers:{number:!0},label:"Otomatik Hesaplanan Bedel (TL)",outlined:"",color:"purple-6","label-color":Ce(Ee).dark.isActive?"purple-3":"purple-6",dense:"",readonly:"",class:be(["kurumsal-responsive hesaplanan-bedel-field",{"text-weight-medium":a.value.HesaplananBedel>0}])},null,8,["modelValue","label-color","class"])]),u("div",el,[o(f,{modelValue:a.value.ToplamBedel,"onUpdate:modelValue":[l[16]||(l[16]=s=>a.value.ToplamBedel=s),da],modelModifiers:{number:!0},label:"Toplam Konaklama Bedeli (TL)",outlined:"",color:"orange-6","label-color":"orange-6",dense:"",type:"number",min:0,required:"",readonly:v.value,disable:v.value,class:"kurumsal-responsive bedel-field"},null,8,["modelValue","readonly","disable"])]),u("div",al,[o(U,{modelValue:a.value.OtgCheckbox,"onUpdate:modelValue":[l[17]||(l[17]=s=>a.value.OtgCheckbox=s),ma],label:"Ö.T.G.",color:"green-6",dense:"",disable:!qe.value,class:"otg-checkbox"},null,8,["modelValue","disable"])]),u("div",ll,[o(f,{modelValue:a.value.OdemeVadesi,"onUpdate:modelValue":l[19]||(l[19]=s=>a.value.OdemeVadesi=s),label:"Ödeme Vadesi *",outlined:"",color:"green-6","label-color":"green-6",dense:"",readonly:"",required:"",class:"kurumsal-responsive odeme-vadesi-field"},{append:n(()=>[o(C,{name:"event",class:"cursor-pointer"},{default:n(()=>[o(Le,{cover:"","transition-show":"scale","transition-hide":"scale",ref_key:"odemeVadesiPopup",ref:re},{default:n(()=>[o(_e,{modelValue:a.value.OdemeVadesi,"onUpdate:modelValue":[l[18]||(l[18]=s=>a.value.OdemeVadesi=s),ea],mask:"DD.MM.YYYY",locale:{days:["Pazar","Pazartesi","Salı","Çarşamba","Perşembe","Cuma","Cumartesi"],daysShort:["Paz","Pts","Sal","Çar","Per","Cum","Cts"],months:["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım","Aralık"],monthsShort:["Oca","Şub","Mar","Nis","May","Haz","Tem","Ağu","Eyl","Eki","Kas","Ara"]},minimal:""},null,8,["modelValue"])]),_:1},512)]),_:1})]),_:1},8,["modelValue"])])]),u("div",sl,[u("div",tl,[o(H,{onClick:l[20]||(l[20]=s=>P.value=!0),label:"Ek Hizmetler",color:"orange",outline:"",icon:"room_service",class:"compact-btn",size:"sm",dense:"",disable:v.value},null,8,["disable"])]),u("div",ol,[o(H,{onClick:je,label:v.value?"GÜNCELLE":"KAYDET",color:"primary",loading:b.value,class:"kurumsal-responsive",size:"md"},null,8,["label","loading"])]),u("div",rl,[o(H,{onClick:fe,label:"TEMİZLE",color:"secondary",outline:"",class:"compact-btn",size:"sm",dense:""})])])]),u("div",il,[o(f,{modelValue:M.value,"onUpdate:modelValue":l[21]||(l[21]=s=>M.value=s),label:"Ek Notlar",outlined:"",color:"indigo-6","label-color":"indigo-6",dense:"",class:be(["kurumsal-responsive",{"konaklama-readonly":v.value}]),readonly:v.value},null,8,["modelValue","class","readonly"])])],512),i.value?(F(),L(Va,{key:0,class:"q-mt-md",dense:""},{default:n(()=>[V(x(i.value),1)]),_:1})):B("",!0)]),_:1},512)]),y.value?(F(),I("div",{key:0,class:"ek-bilgiler-container",ref_key:"ekBilgilerContainerRef",ref:G},[u("div",ul,[o(f,{modelValue:t.value.MstrDgmTarihi,"onUpdate:modelValue":l[24]||(l[24]=s=>t.value.MstrDgmTarihi=s),label:"Doğum Tarihi",dense:"",outlined:"",color:"teal-6","label-color":"teal-7",class:"text-caption full-width-input",readonly:""},{append:n(()=>[o(C,{name:"event",class:"cursor-pointer"},{default:n(()=>[o(Le,{cover:"","transition-show":"scale","transition-hide":"scale",ref_key:"datePopup",ref:oe},{default:n(()=>[o(_e,{modelValue:t.value.MstrDgmTarihi,"onUpdate:modelValue":[l[23]||(l[23]=s=>t.value.MstrDgmTarihi=s),Je],mask:"DD.MM.YYYY",locale:{days:["Pazar","Pazartesi","Salı","Çarşamba","Perşembe","Cuma","Cumartesi"],daysShort:["Paz","Pts","Sal","Çar","Per","Cum","Cts"],months:["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım","Aralık"],monthsShort:["Oca","Şub","Mar","Nis","May","Haz","Tem","Ağu","Eyl","Eki","Kas","Ara"]},minimal:""},null,8,["modelValue"])]),_:1},512)]),_:1})]),_:1},8,["modelValue"]),o(f,{modelValue:t.value.MstrTel2,"onUpdate:modelValue":l[25]||(l[25]=s=>t.value.MstrTel2=s),label:"2. Telefon No",dense:"",outlined:"",color:"teal-6","label-color":"teal-7",class:"text-caption full-width-input"},null,8,["modelValue"]),o(f,{modelValue:t.value.MstrEposta,"onUpdate:modelValue":l[26]||(l[26]=s=>t.value.MstrEposta=s),label:"E-posta",type:"email",dense:"",outlined:"",color:"teal-6","label-color":"teal-7",class:"text-caption full-width-input"},null,8,["modelValue"]),o(f,{modelValue:t.value.MstrMeslek,"onUpdate:modelValue":l[27]||(l[27]=s=>t.value.MstrMeslek=s),label:"Meslek",dense:"",outlined:"",color:"teal-6","label-color":"teal-7",class:"text-caption full-width-input"},null,8,["modelValue"]),o(f,{modelValue:t.value.MstrYakini,"onUpdate:modelValue":l[28]||(l[28]=s=>t.value.MstrYakini=s),label:"Yakını",dense:"",outlined:"",color:"teal-6","label-color":"teal-7",class:"text-caption full-width-input"},null,8,["modelValue"]),o(f,{modelValue:t.value.MstrYknTel,"onUpdate:modelValue":l[29]||(l[29]=s=>t.value.MstrYknTel=s),label:"Yakın Tel",dense:"",outlined:"",color:"teal-6","label-color":"teal-7",class:"text-caption full-width-input"},null,8,["modelValue"]),o(f,{modelValue:t.value.MstrAdres,"onUpdate:modelValue":l[30]||(l[30]=s=>t.value.MstrAdres=s),label:"Adres",type:"textarea",rows:"3",dense:"",outlined:"",color:"teal-6","label-color":"teal-7",class:"text-caption full-width-input"},null,8,["modelValue"]),o(f,{modelValue:t.value.MstrNot,"onUpdate:modelValue":l[31]||(l[31]=s=>t.value.MstrNot=s),label:"Not",type:"textarea",rows:"2",dense:"",outlined:"",color:"teal-6","label-color":"teal-7",class:"text-caption full-width-input"},null,8,["modelValue"])])],512)):B("",!0)])])]),o(Ge,{modelValue:P.value,"onUpdate:modelValue":l[38]||(l[38]=s=>P.value=s),"no-esc-dismiss":"","no-backdrop-dismiss":""},{default:n(()=>[o(He,{class:"ek-hizmetler-dialog",style:{width:"350px","max-width":"350px"}},{default:n(()=>[o(te,{class:"q-pb-xs"},{default:n(()=>[u("div",nl,[u("div",dl,[o(U,{modelValue:g.value.dahil,"onUpdate:modelValue":[l[32]||(l[32]=s=>g.value.dahil=s),k],label:"Depozito Bedeli:",color:"orange",dense:"",class:"text-orange-7 text-weight-medium"},null,8,["modelValue"]),o(f,{modelValue:g.value.bedel,"onUpdate:modelValue":[l[33]||(l[33]=s=>g.value.bedel=s),k],modelModifiers:{number:!0},type:"number",suffix:"₺",dense:"",outlined:"",color:"orange",disable:!g.value.dahil,style:{width:"120px"},class:"depozito-input"},null,8,["modelValue","disable"])])])]),_:1}),o(ba),o(te,{class:"q-pt-sm"},{default:n(()=>[u("div",ml,[u("div",vl,[o(U,{modelValue:p.value.kahvaltiDahil,"onUpdate:modelValue":[l[34]||(l[34]=s=>p.value.kahvaltiDahil=s),k],label:"Kahvaltı Dahil",color:"primary",disable:a.value.KonaklamaTipi!=="GÜNLÜK"},null,8,["modelValue","disable"]),o(U,{modelValue:p.value.havluVerildi,"onUpdate:modelValue":[l[35]||(l[35]=s=>p.value.havluVerildi=s),k],label:"Havlu Verildi",color:"primary"},null,8,["modelValue"]),o(U,{modelValue:p.value.prizVerildi,"onUpdate:modelValue":[l[36]||(l[36]=s=>p.value.prizVerildi=s),k],label:"Priz Verildi",color:"primary"},null,8,["modelValue"]),o(U,{modelValue:p.value.geceKonaklama,"onUpdate:modelValue":[l[37]||(l[37]=s=>p.value.geceKonaklama=s),k],label:"Geç Saat Konaklama",color:"primary",disable:a.value.KonaklamaSuresi>1||!J.value},{default:n(()=>[J.value?a.value.KonaklamaSuresi>1?(F(),L(X,{key:1,class:"bg-orange text-white text-body2",delay:500},{default:n(()=>[o(C,{name:"info",class:"q-mr-xs"}),l[44]||(l[44]=V(" Geç Saat Konaklama sadece 1 günlük konaklamalarda seçilebilir "))]),_:1,__:[44]})):B("",!0):(F(),L(X,{key:0,class:"bg-orange text-white text-body2",delay:500},{default:n(()=>[o(C,{name:"schedule",class:"q-mr-xs"}),l[43]||(l[43]=V(" Geç Saat Konaklama sadece 00:00 - 04:00 saatleri arasında seçilebilir "))]),_:1,__:[43]}))]),_:1},8,["modelValue","disable"])])])]),_:1}),o(ze,{align:"right"},{default:n(()=>[o(H,{flat:"",label:"İptal",color:"grey",onClick:Ze}),o(H,{flat:"",label:"Tamam",color:"primary",onClick:Xe})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(Ge,{modelValue:Q.value,"onUpdate:modelValue":l[39]||(l[39]=s=>Q.value=s),persistent:"",class:"floating-dialog"},{default:n(()=>[o(He,{style:{"min-width":"500px","max-width":"600px"},class:"draggable-card"},{default:n(()=>[o(te,{class:"row items-center q-pb-none bg-red text-white cursor-move q-card__section--head",onMousedown:ra},{default:n(()=>[o(C,{name:"block",size:"md",class:"q-mr-sm"}),l[45]||(l[45]=u("div",{class:"text-h6"},"🚨 KARA LİSTE MÜŞTERİSİ",-1))]),_:1,__:[45]}),O.value?(F(),L(te,{key:0},{default:n(()=>[u("div",cl,[o(C,{name:"warning",size:"4rem",color:"red-6"})]),l[52]||(l[52]=u("div",{class:"text-h6 text-center text-red-6 q-mb-md"}," Müşteri kara listeden çıkarılmadan işlem yapılamaz. ",-1)),l[53]||(l[53]=u("div",{class:"text-body1 text-center q-mb-md"}," Kara listeden çıkarmayı onaylıyor musunuz? ",-1)),u("div",pl,[l[50]||(l[50]=u("strong",null,"Müşteri Bilgileri:",-1)),u("ul",fl,[u("li",null,[l[46]||(l[46]=u("strong",null,"TC:",-1)),V(" "+x(O.value.MstrTCN),1)]),u("li",null,[l[47]||(l[47]=u("strong",null,"Adı:",-1)),V(" "+x(O.value.MstrAdi),1)]),O.value.MstrTelNo?(F(),I("li",kl,[l[48]||(l[48]=u("strong",null,"Telefon:",-1)),V(" "+x(O.value.MstrTelNo),1)])):B("",!0),O.value.MstrFirma?(F(),I("li",Ml,[l[49]||(l[49]=u("strong",null,"Firma:",-1)),V(" "+x(O.value.MstrFirma),1)])):B("",!0)])]),O.value.KnklmNot?(F(),I("div",Tl,[l[51]||(l[51]=u("strong",null,"Kara Liste Sebebi:",-1)),u("div",gl,x(O.value.KnklmNot),1)])):B("",!0)]),_:1,__:[52,53]})):B("",!0),o(ze,{align:"center",class:"q-gutter-sm"},{default:n(()=>[o(H,{label:"EVET",color:"green",style:{"min-width":"120px"},onClick:ta,loading:de.value},null,8,["loading"]),o(H,{label:"HAYIR",color:"red",outlined:"",style:{"min-width":"120px"},onClick:oa})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1,__:[54]}))}}),Al=Oa(bl,[["__scopeId","data-v-c45b919c"]]);export{Al as default};
